from Crypto.Util.number import *
from sympy import *
from secret import flag,hint1

def getn():
    while(1):
        p = getPrime(128)
        error = getPrime(40)
        q = 2*p + error
        r = 2*q + error
        if(isPrime(q) and isPrime(r)):
            n = p*q*r
            break
    return (p,n)

e = 65537

#step 1
p1,n1 = getn()
hint1_enc = pow(bytes_to_long(hint1),e,n1)
print("hint1_enc =",hint1_enc)
print("p1 =",p1)
print("n1 =",n1)


#step_2
p = getPrime(512)
q = getPrime(512)
n = p*q

a = getPrime(512)
b = getPrime(16)
m = bytes_to_long(flag)
hint2 = pow((a*p + b),q,n)
c = pow(m,e,n)
print("hint2 =",hint2)
print("n =",n)
print("c =",c)

'''
hint1_enc = 81410455638978409164259444919301919004039168105498097066894873200032325739015513072857302922621201132563677863689691
p1 = 262726397885004821911124269672266219817
n1 = 145077853507975436750834997262072948658867600956220420571072608726655109502006223745168041173033352252243905006874073
hint2 = 76365961284206788846337118586080088152618427584031945902089660388319933927923116270501939183895761439446801300651172452036828117326634075602939230046403952964582219445745421072754817834269688283542670097365551320401087865123678477038236635371384773086853444993428846209267595537649428971235394440131039392625
n = 110209520206742741948506756493191161913926109540508718881123685741911222474420697491281731367887008521387736563780864849109401713213647085815879126117587521279674073324987130883917954090177227594558649375661722804112176864417280291159808392760730415028629655809584763163285199014692393327204538254936430590899
c = 84345299633297789297352837849279001204443711590121337540969236692610027337278928626589856468208700831865337971235547581848958840387276084420274713889748413312878922978315147540373062163315353337156724430913048750658116980983932277459029396584928058181491602354057215920794976679755061517240435678912670575892
'''